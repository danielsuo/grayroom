cmake_minimum_required (VERSION 3.1)

include (ExternalProject)

set (HALIDE_EXTERNAL_PROJECT halide-git)
message (${CMAKE_CURRENT_BINARY_DIR})
set (HALIDE_SOURCE_DIR ${CMAKE_CURRENT_BINARY_DIR}/${HALIDE_EXTERNAL_PROJECT}-prefix/src/${HALIDE_EXTERNAL_PROJECT}/)

ExternalProject_Add (
  ${HALIDE_EXTERNAL_PROJECT}
  GIT_REPOSITORY "https://github.com/halide/Halide.git"
  GIT_TAG "master"
  UPDATE_COMMAND ""
  CONFIGURE_COMMAND cmake -DCMAKE_BUILD_TYPE=Release ${HALIDE_SOURCE_DIR}
  BUILD_COMMAND make -j8
  INSTALL_COMMAND ""
  )

set (HALIDE_EXTERNAL_PROJECT ${HALIDE_EXTERNAL_PROJECT} PARENT_SCOPE)
set (HALIDE_INCLUDE_DIRS ${CMAKE_CURRENT_BINARY_DIR}/${HALIDE_EXTERNAL_PROJECT}-prefix/src/${HALIDE_EXTERNAL_PROJECT}-build/include PARENT_SCOPE)
set (HALIDE_LIBRARY_DIRS ${CMAKE_CURRENT_BINARY_DIR}/${HALIDE_EXTERNAL_PROJECT}-prefix/src/${HALIDE_EXTERNAL_PROJECT}-build/lib PARENT_SCOPE)
